\section {Algoritmo FST para bissecção}

	\subsection{Teorema do corte exato}
	\begin{lem}
	\label{lem:grauMaximo}
		Para toda árvore~$T$ com~$n>2$ vértices
		e toda aresta~${e=\{v_1,v_2\}}$ em~$T$, 
		tal que~$v_1,v_2\in V$ e~${\grau_T(v_1)=\grau_T(v_2)=1}$,
		temos que~${\Delta(T) = \Delta(T\cup e)}$.
	\end{lem}
	
	
	\begin{proof}
		Como~$n>2$ vértices, então temos que~$\Delta(T)\ge 2$.
		Sabemos que ao adicionar~$e$ em~$T$, o grau de~$v_1$
		e~$v_2$ passará a ser 2, e os demais vértices não terão
		o grau alterado.
		
		Seja~$v$ um vértice de~$T$ tal 
		que~${\grau_T(v) = \Delta(T)\le 2}$,
		dado que~${\grau_T(v_1)=\grau_T(v_2)=1}$
		sabe-se que~${v\ne v_1}$ e~${v\ne v_2}$, o que leva 
		a~${\grau_{T\cup e}(v)=\grau_T(v)=\Delta(T)}$.

		
		Dessa forma, temos que
		\begin{align}
			\Delta(T\cup e) &= \max\{\grau_{T\cup e}(v_1), 
			\grau_{T\cup e}(v)\}\nonumber\\
         		&= \max\{2, \grau_{T\cup e}(v)\} \nonumber\\
				&= \grau_{T\cup e}(v) \nonumber\\
         		&= \grau_T(v) \nonumber\\
         		&= \Delta(T) \nonumber
		\end{align}		

	\end{proof}

	\bigskip
	\bigskip
	\bigskip

	\begin{teo}[Teorema do corte exato
	{\cite[Theorem 6]{Schmidt15}}]
	\label{teo:corteExato}
		Para todo~${i\in \mathbb{N^+_*}}$, toda árvore~$T$ com~$n$
		vértices e~${diam^*(T)>\dfrac{1}{2^i}}$, e todo~${m\in[n]}$,
		existe um corte~$(B,W)$ em~$T$ com~$|B|=m$ 
		e~$e_T(B,W)\le 4\cdot 2^i\cdot \Delta(T)$.
		Um corte que satisfaz esses requisitos pode ser computado
		em tempo~${O\Big(\dfrac{n}{diam^*(T)}\Big)}$.
	\end{teo}

	\medskip
	\medskip

	\begin{proof}
		Utilizaremos indução para provar o 
		Teorema~\ref{teo:corteExato} 
		(não levaremos em conta o tempo de execução agora).
		
		Primeiramente, temos que~${diam^*(T)\le1}$, como o mostrado 
		na seção~\ref{subsec:diametro}. 
		Sendo assim, sabe-se que~${i\ge1}$, logo~${i=1}$ será a base 
		utilizada na indução.
		
		Caso base,~${i=1}$.
		Para todo~${n\le 2}$, sabe-se que~${|E(T)|=\Delta(T)}$, e nesse
		caso,~${e_T(B,W)\le |E(T)|=\Delta(T)\le 4\cdot 2^i\cdot 
		\Delta(T)}$.
		Para~$n>2$ temos que~${diam^*(T)>\dfrac{1}{2}}$, logo, 
		podemos utilizar o Lema~\ref{lema:caminhoLongo} para obter 
		um corte~$(B,W)$ 
		com~${e_T(B,W)\le 2 < 4\cdot 2^i\cdot \Delta(T)}$.
		Portanto, esse teorema é válido para~${i=1}$.


		Caso~${i\ge 2}$. Provaremos que esse teorema vale para~$i$, 
		assumindo que ele é válido para~$i-1$.
		De modo semelhante ao caso anterior, para~${n\le2}$, temos 
		que~${e_T(B,W)\le |E(T)|=\Delta(T)\le 2\cdot 2^i\cdot 
		\Delta(T)}$.
		Porém, se~${n>2}$, podemos utilizar o 
		Teorema~\ref{teo:dobraDiametro}, que nos devolverá cortes 
		do tipo 1 ou 2.
		\begin{itemize}
			\item Se for do tipo 1, teremos~${|B|=m}$ 
			e~${e_T(B,W)\le2\le 2\cdot 2^i\cdot \Delta(T)}$.

			\item Se for do tipo 2, podemos obter um 
			corte~$(B',W',S')$
			tal que~${|B'|=m}$ ou~${|B'|<m\le |B'|+|S'|}$
			com~${e_T(B',W',S')\le \dfrac{2\cdot\Delta(T)}{diam^*(T)}\le
			2\cdot2^i\cdot\Delta(T)}$.
			
			Se~${|B'|=m}$, temos então as propriedades do corte desse
			teorema.

			Caso contrário,~${|B'|<m\le |B'|+|S'|}$, o que nos leva 
			a~${0<m-|B'|\le|S'|}$. 
			Pelas propriedades do Teorema~\ref{teo:dobraDiametro}, 
			sabemos que~${diam^*(T[S'])\ge 2\cdot diam^*(T)>
			\dfrac{1}{2^{i-1}}}$.
			Como~${0<m-|B'|\le|S'|}$ 
			e~${diam^*(T[S'])>\dfrac{1}{2^{i-1}}}$, podemos usar o 
			Teorema~\ref{teo:corteExato} em~$T[S]$ com~$m$ 
			valendo~${m-|B'|}$ e~$i$ valendo~${i-1}$.
			
			Porém, existem casos onde o conjunto~$S'$ retornado 
			pelo Teorema~\ref{teo:dobraDiametro} não é conexo, 
			pois, de acordo com o 
			Algoritmo~\ref{alg:dobraDiametro},~$S'$ pode se 
			dividir em duas componentes, uma no começo e outra
			no fim do caminho máximo, como o mostrado na figura 
			abaixo. 


			\begin{center} \begin{tikzpicture}
				[scale=.625,auto=left,
				every node/.style={circle, draw=black,
					fill=blue!20}]

				\draw [draw=blue!65,fill=yellow!20] (-1,1.5) 
				rectangle (7, 6.5);

				\draw [draw=none, fill=yellow!20] (11,4.7) 
				rectangle (19, 6.5);
				\draw [draw=none, fill=yellow!20] (13.5,1.5) 
				rectangle (19, 6.5);

				\node [text=blue!65,draw=none, fill=none] at 
				(0,2.5) {\Large{$S$}};
				\node [text=blue!65,draw=none, fill=none] at 
				(18,2.5) {\Large{$S$}};

				\node [subtree] (y1) at (3,4.6)  {};
				\node [subtree, fill=red!30] (y2) at (6,5)  {};
				\node [subtree] (y3) at (9,4.6)  {};
				\node [subtree] (y4) at (12,5) {};
				\node [subtree] (y5) at (15,4.6) {};

				\node (x0) at (0,5.4)  {$v_0$};
				\node (x1) at (3,5)    {...};
				\node (x2) at (6,5.4)  {$v_i$};
				\node (x3) at (9,5)    {...};
				\node (x4) at (12,5.4) {$v_j$};
				\node (x5) at (15,5)   {...};
				\node (x6) at (18,5.4) {$v_p$};

				\foreach \from/\to in {x0/x1,x1/x2,x2/x3,x3/x4,
				x4/x5,x5/x6}
				\draw (\from) -- (\to);

				% Define the points of a regular pentagon
				\path (13.5,4.7) coordinate (P0);
				\path (11,4.7) coordinate (P1);
				\path (11,6.5) coordinate (P2);
				\path (19,6.5) coordinate (P3);
				\path (19,1.5) coordinate (P4);
				\path (13.5,1.5) coordinate (P5);
				% Draw the edges of the pentagon
				\draw[draw=blue!65] (P0) -- (P1) -- (P2) -- (P3) 
				-- (P4) -- (P5) -- cycle;


			\end{tikzpicture} \end{center}

			Como o Teorema~\ref{teo:corteExato} se trata de 
			árvores, precisamos tornar~$S'$ conexo de forma a não 
			alterar o~$\Delta(T)$.
			Sabemos que se adicionarmos uma aresta~$e$ em~$T$, que 
			liga o primeiro ao último vértice do caminho máximo,
			então~$S'$ será conexo. 
			Diremos que~${T' = T\cup e}$.

			Nota-se também que em ambas as componentes de~$S'$, 
			temos que o caminho máximo de cada uma é a interseção 
			entre o caminho máximo de~$T$ e a componente.
			Logo, se adicionando~$e$, teremos um caminho máximo 
			em~$S'$ e preservaremos, em parte, o caminho máximo 
			de~$T$. 
			Além disso, de acordo com o Lema~\ref{lem:grauMaximo}, 
			teremos que~${\Delta(T) = \Delta(T')}$, já que~$e$ 
			conectará dois vértices extremos do caminho máximo, 
			que possuem grau um.
			Podemos, então, passar a árvore~$T'[S']$ para o 
			Teorema~\ref{teo:corteExato}, sem nos preocupar com a 
			modificação do grau máximo.
			
			Como assumimos que o Teorema~\ref{teo:corteExato} vale
			para~${i-1}$, então existe um corte~$(B'',W'')$
			tal que~${|B''|=m-|B'|}$ 
			e~${e_{T[S]}(B'',W'')\le 4\cdot 2^{i-1}\cdot
			\Delta(T'[S'])\le 4\cdot 2^{i-1}\cdot\Delta(T')}$.

			Dessa forma, sabemos que existe um corte~$(B,W)$ tal
			que~${B=B'\cup B''}$ e~${W=V(T)\setminus B}$, sendo 
			que~${|B|=|B'| + m-|B'| = m}$ e
			\begin{align}
				e_T(B,W)&\le e_T(B',W',S') + e_{T[S]}(B'',W'') 
				\nonumber\\
				&\le 2\cdot2^i\cdot\Delta(T) + 4\cdot 2^{i-1}\cdot
				\Delta(T')\nonumber\\
				&\le 2\cdot2^i\cdot\Delta(T) + 4\cdot 2^{i-1}\cdot
				\Delta(T)\nonumber\\
				&\le 4\cdot 2^{i}\cdot\Delta(T) \nonumber
			\end{align}
			provando assim que o Teorema~\ref{teo:corteExato} é
			válido para~$i$ partindo do pressuposto de que ele vale
			para~${i-1}$. Logo, temos que o 
			Teorema~\ref{teo:corteExato} é válido para 
			todo~${i\in \mathbb{N^+_*}}$.
			
		\end{itemize}
	\end{proof}

	\bigskip
	\bigskip
	\bigskip
	\bigskip
	\bigskip

	\subsection{Algoritmo do corte exato}

		Seja~${T=(V,E)}$ uma árvore e~${v_1,v_2\in V}$.
		% Assumimos que a função INSERE\_ARESTA$(T,v_1,v_2)$ irá 
		% inserir uma aresta em~$T$, ligando os 
		% vértices~$v_1$ e~$v_2$ em tempo constante. 
		Assumimos que a função COMPUTA\_CAMINHO\_MÁXIMO$(T)$ 
		devolve um vetor contendo os vértices do caminho 
		máximo, de acordo com a ordem que aparecem no caminho, 
		isso pode ser feito em tempo~$O(n)$, como o descrito na 
		seção~\ref{sec:caminhoMaximo}.

		% Seja~$vet$ um vetor, temos que as funções PRIMEIRO$(vet)$ 
		% e ULTIMO$(vet)$ devolvem o primeiro e o último elementos 
		% do vetor, respectivamente em tempo constante.

		Segue o algoritmo que encontra um corte que satisfaz as 
		propriedades do Teorema~\ref{teo:corteExato}.
		
		\bigskip
		\bigskip
		\begin{algorithm}[H]
		\label{alg:corteExato}
			\SetKwInOut{Input}{input}
			\SetKwInOut{Output}{outp}

			\caption{Computa corte exato em uma árvore}
			\Input{árvore $T=(V,E)$ com $n$ vértices e $m\in[n]$}
			\Output{corte $(B,W)$ tal que $|B|=m$}
			$B\gets \emptyset$\;
			$S'\gets V$\;
			$raiz\gets$ um vértice arbitrário de~$T$\;
	
			\While{$|B|<m$}
			{
				$P\gets$ COMPUTA\_CAMINHO\_MAXIMO$(T[S'])$\;
				$[(B',W',S'), raiz]\gets$
				Algoritmo\ref{alg:dobraDiametro}$(T[S']$,
				$|S'|$, $m-|B|$, $P$, $raiz)$\;
				$B\gets B\cup B'$\;

				% \If{$T[S']$ não é conexo}
				% {
				% 	INSERE\_ARESTA$(T[S']$, PRIMEIRO$(P)$, 
				% 	ULTIMO$(P))$\;
				% }
			}
			\Return $(B,V\setminus B)$\;

		\end{algorithm}	

		\bigskip
		\bigskip
		\bigskip

		\textbf{Análise do Algoritmo}

		% Sabe-se que calcular um caminho máximo faz parte do
		% Teorema~\ref{teo:dobraDiametro} e deveria estar no
		% Algoritmo~\ref{alg:dobraDiametro}, mas, precisamos 
		%acessar 
		% esse caminho máximo para, possivelmente, acrescentar a 
		% aresta citada na prova do Teorema~\ref{teo:corteExato}, 
		% portanto, encontrar um caminho máximo fará parte do 
		% Algoritmo~\ref{alg:corteExato}.

		No algoritmo, temos que transformar o conjunto de 
		vértices~$S'$ em um grafo. 
		Poderíamos fazer isso verificando todas as arestas que 
		ligam dois vértices de~$S'$ e colocar no grafo, mas podemos
		fazer isso no Algoritmo~\ref{alg:dobraDiametro} de forma 
		mais eficiente. 
		Sabemos que no Algoritmo~\ref{alg:dobraDiametro},
		analisamos os vértices de~$S'$ que se ligam a vértices 
		de~$V(T)\setminus S'$. 
		Portanto, podemos usar uma marcação para indicar que as 
		arestas que ligam~$S'$ e~$V(T)\setminus S$ estão inativas, 
		tornando $S'$ uma componente conexa isolada. 
		Isso pode ser feito em tempo~$O(1)$.
		O Algoritmo~\ref{alg:dobraDiametro} também devolverá 
		algum vértice de~$S'$ que será usado como raiz na 
		próxima interação do Algoritmo~\ref{alg:dobraDiametro}.

		Acrescentar a aresta~$e$, como o descrito no
		Teorema~\ref{teo:corteExato} também pode ser feito de 
		forma mais simples no Algoritmo~\ref{alg:dobraDiametro},
		que assim como 