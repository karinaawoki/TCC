\documentclass[a4paper,12pt]{article}

% Para usar a linguagem PT-BR.
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{tikz}
\usepackage[brazilian]{babel}
\usepackage[titlenumbered,ruled]{algorithm2e}
\usepackage{amsthm}


\selectlanguage{brazilian} 

\newtheorem{lem}{Lema}
\newtheorem{alg}{Descrevendo o algoritmo}

\newcommand{\Oh}{\mathrm{O}}

\sloppy

\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%  SEÇÃO 6     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section {Algoritmos de cortes aproximados **6}

Em \cite{Schmidt15}, são apresentados dois algoritmos que, dada uma 
floresta $G$ e um inteiro $0<m\le n$, onde $n$ é o número de vértices 
de $G$, produzem cortes com algumas propriedades.

Abaixo reproduzimos os dois resultados de \cite{Schmidt15} que 
atestam as propriedades dos cortes produzidos por estes algoritmos:

\bigskip
\bigskip
\bigskip
\bigskip

\begin{lem}[Lema do corte aproximado simples para árvores]

	Para toda árvore $T=(V,E)$ com $n$ vértices e todo $m \in [n]$,
	existe um corte $(B,W)$ em $T$ tal que 
	$\frac{m}{2} <|B| \le m$,
	$e_T(B,W) \le \Delta(T)$.
	Um corte que satisfaz esses requisitos pode ser computado em
	tempo $O(n)$.
\end{lem}

\medskip

\begin{alg}
	É fácil ver que se $m=n$, então os valores $B = V$ e $W = \emptyset$ 
	satisfazem o lema, dado que $e_G(B,W)$ será $0$. Isso pode ser 
	computado em tempo $O(n)$.

	Caso contrário, é necessário escolher uma raíz arbitrária $r$ para $T$
	e salvar em um vetor o número de vértices das sub-árvores enraizadas 
	em cada um dos nós, que é igual ao número de descendentes somado a 1.
	Isso serve para que saibamos a quantidade de vértices das sub-árvores
	sem que precisemos percorrer todos os nós das sub-árvores a cada consulta.

	Feito isso, temos que $v$ é o vértice analisado no momento e 
	$V_1, V_2, \ldots, V_k$ são as sub-árvores enraizadas nos $k$ filhos
	de $v$.
	Se algum $V_i$ satisfizer $\frac{m}{2}<|V_i|\le m$, podemos retornar
	a sub-árvore $|V_i|$ como sendo o conjunto $B$, satisfazendo o Lema 1,
	dado que o corte será $1$.
	Caso contrário, se algum $V_i$ satisfizer $|V_i|> m$, assumimos que 
	$v$ agora é a raíz de $V_i$ e aplicamos novamente esse processo em $v$.

	Nota-se que esse procedimento irá parar em algum momento, dado que a árvore 
	é finita, e ele parará quando encontrar
	uma sub-árvore que satisfaça o Lema 1 (e essa sub-árvore será o conjunto $B$) 
	ou quando chegarmos numa situação em que  
	$|V_i|\le \frac{m}{2}$ para todos os $k$ filhos de $v$.
	Nesse último caso, sabemos que $|V_1\cup V_2\cup \ldots \cup V_k|\ge m$, pois
	a sub-árvore enraizada em $v$ possui mais que $m$ vértices. 
	E sabemos também que $|V_i|\le \frac{m}{2}$ para todos os $k$ filhos de $v$. 
	Com isso, percorremos os $V_i$ em ordem, e 
	adicionamos $V_i$ ao conjunto $B$, parando antes que $|B| > m$. E isso nos dará
	$e_T(B,V-B) < v \le \Delta(T)$, o que satisfaz o lema.
	Sabemos que existe um $i$ tal que 
	$\frac{m}{2} < |V_1 \cup V_2 \cup \ldots \cup V_i| \le m$, pois a sub-árvore
	enraizada em $v$ possui mais que $m$ vértices e que se $|V_i|\le \frac{m}{2}$,
	então $|V_i \cup V_{i+1}| \le m$.

\end{alg}


\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%% LEMA 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{lem}[Lema do corte aproximado simples {\cite[Lemma 2]{Schmidt15}}]

	Para toda floresta $G=(V,E)$ com $n$ vértices e todo $m \in [n]$,
	existe um corte $(B,W)$ em $G$ tal que 
	$\frac{m}{2} <|B| \le m$,
	$e_G(B,W) \le \Delta(G)$.
	Um corte que satisfaz esses requisitos pode ser computado em
	tempo $O(n)$.
\end{lem}

\medskip

Nota-se que esse lema é uma adaptação do anterior, trocando árvore
por floresta.

\medskip

\begin{alg}
	Temos que $T_1, T_2, \ldots,T_j $ são 
	as árvores de $G$. 
	Primeiro percorremos as árvores na ordem apresentada 
	anteriormente. Seja $l$ o maior inteiro tal que 
	$s = \displaystyle\sum_{i=1}^{l}|V(T_i)| \le m$,
	colocamos $T_1,T_2, \ldots,T_l$ no conjunto $B$.
	Caso $s=m$, temos $|B|=m$ com  $e_G(B,W)=0$, o que satisfaz o lema.
	Caso contrário, se encontrarmos um corte $(B',W')$ em $T_l+1$ que
	satisfaça $\frac{m-s}{2}<|B'|\le m-s$ com $e_{T_{l+1}}(B',W') \le 
	\Delta(T_{l+1})$, e acrescentarmos $B'$ no conjunto
	$B$, teremos
	$\frac{m+s}{2}<|B| \le m$ com 
	$e_G(B,W) = \Delta(T_{l+1}) \le \Delta(G)$.
	Logo, podemos acrescentar $B'$ em $B$ e teremos um corte
	que satisfaz o lema, e podemos fazer isso utilizando o Lema 1.

\end{alg}

\begin{algorithm}[H]
	\SetKwInOut{Input}{input}
	\SetKwInOut{Output}{output}

	\caption{Computa corte aproximado simples}
	\Input{floresta $G = (V,E)$ com $n$ vértices e $m \in [n]$}
	\Output{Um corte $(B,W)$ tal que $\frac{m}{2}\le|B|\le m$}
	$B \gets \emptyset$\;

	\For{$i=1 \to k$, sendo $k$ o número de árvores}{
		\eIf{$|V_i| + |B|\le m$}{
			 $B \gets B\cup V_i$\;
		}	
		{
			Encontrar um corte $(B',W')$ em $G[V_i]$ com 
			$\frac{m-|B|}{2} <|B'| \le m-|B|$ (usando o Lema 2)\;

			$B \gets B\cup B'$\;

			break\;
		}	
	}
	\Return $(B,V-B)$\;

\end{algorithm}	

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%% LEMA 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{lem}[Lema do corte aproximado {\cite[Lemma 3]{Schmidt15}}]

	Para toda floresta $G=(V,E)$ com $n$ vértices, todo $m \in [n]$
	e todo $c \in [0,1)$,
	existe um corte $(B,W)$ em $G$ tal que 
	$cm \le |B| \le m$,
	$e_G(B,W) \le \lceil \frac{2c}{1-c}\rceil \Delta(G)$.
	Um corte que satisfaz esses requisitos pode ser computado em
	tempo $O(n)$.
\end{lem}

\medskip

\begin{alg}
	
	Sabemos que se $c \le \frac{1}{2}$, podemos aplicar o Lema 2, 
	dado que o resultado nos dará um conjunto $B'$ tal que
	$|B'|>\frac{m}{2}\ge cm$.

	Inicialmente temos que $B = \emptyset$.
	Executaremos o Lema 2 diversas vezes para encontrar 
	um corte $(B',W')$ em $G[V-B]$ tal que $\frac{m-|B|}{2}<|B'|\le m-|B|$,
	acrescentando o conjunto $B'$ a $B$ em cada uma das chamadas ao Lema 2.
	Fazemos isso até que $|B|\ge cm$ seja satisfeito.
	Nota-se que em algum momento $|B|\ge cm$ irá ocorrer, pois a cada vez
	que executamos o Lema 2, acrescentamos pelo menos um vértice em $B$,
	e $|B|>m$ nunca irá ocorrer, pois o Lema 2 adicionará no máximo 
	$m-|B|$ vértices em $B$.

\end{alg}

\begin{algorithm}[H]
	\SetKwInOut{Input}{input}
	\SetKwInOut{Output}{output}

	\caption{Computa corte aproximado}
	\Input{floresta $G = (V,E)$ com $n$ vértices, $m \in [n]$, 
	$c\in (\frac{1}{2}, 1)$}
	\Output{Um corte $(B,W)$ tal que $cm\le|B|\le m$}
	$B \gets \emptyset$\;
	\eIf{$c\le \frac{1}{2}$}{
		Encontrar um corte $(B',W')$ em $G$ com $\frac{m}{2} <|B'| \le m$ 
		(usando o Lema 2)\;
		
		$B \gets B'$\;
	}
	{
		\While{$|B|<cm$}{
			Encontrar um corte $(B',W')$ em $G[V-B]$ com 
			$\frac{m-|B|}{2} <|B'| \le m-|B|$ (usando o Lema 2)\;

			$B \gets B\cup B'$\;		
		}
	}
	\Return $(B,V-B)$

\end{algorithm}	

\newpage
\bibliographystyle{plain}
\bibliography{refs}
\end{document}
